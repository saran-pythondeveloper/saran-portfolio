class masonry{constructor({parent:t=document.querySelector("#masonry"),links:e=document.querySelectorAll("[data-masonry-link]"),active:i="active",margin:s=20,responsive:n={980:{columns:3},480:{columns:2},0:{columns:1}},fadeDuration:a={in:300,out:0}}={}){this.parent=t,this.links=Array.from(e),this.active=i,this.margin=s,this.responsive=n,this.fadeDuration=a,this.elements=Array.from(this.parent.children),this.activeElements=this.elements,this.columns=1,this.dataLink="all",this.winWidth=window.innerWidth,this.init()}orderelements(){let{parent:t,activeElements:e,columns:a,blocWidth:r,margin:l}=this;var i=e.reduce((t,e,i)=>{var s=this._sumArrHeight(t,a),n=i%a*(r+l),s=0<=i-a?s[i%a]+l*Math.floor(i/a):0;return e.style.transform=`translate3d(${n}px, ${s}px, 0)`,t.push(e.offsetHeight),t},[]),i=this._sumArrHeight(i,a),i=Math.max(...i)+l*(Math.floor(e.length/a)-1);t.style.height=i+"px"}handleFilterClick(t,e){t.preventDefault();let{links:i,active:s}=this;e.dataset.masonryLink!==this.dataLink&&(this.dataLink=e.dataset.masonryLink,i.forEach(t=>{t.isEqualNode(e)?t.classList.add(s):t.classList.remove(s)}),this._filterElements(()=>{this.orderelements()}))}resize(){window.addEventListener("resize",()=>{clearTimeout(window.sortableResize),window.sortableResize=setTimeout(()=>{this.winWidth=window.innerWidth,this._setBlocWidth(()=>{this.orderelements()})},500)})}init(){let{parent:t,links:e,active:i}=this;e.forEach((e,t)=>{0===t&&(e.classList.add(i),this.dataLink=e.dataset.masonryLink),e.addEventListener("click",t=>{this.handleFilterClick(t,e)})}),this._setBlocWidth(),window.addEventListener("load",()=>{this._filterElements(()=>{this.orderelements()}),t.style.opacity=1}),this.resize()}_setBlocWidth(t){var{parent:e,elements:i,margin:s,responsive:n}=this,n=this.columns=this._columnsCount(n).columns;let a=this.blocWidth=(e.clientWidth-s*(n-1))/n;i.forEach(t=>{t.style.width=a+"px"}),t&&t()}_filterElements(t){let{elements:e,dataLink:i,fadeDuration:s}=this;this.activeElements=e.filter(t=>"all"!==i&&t.dataset.masonryEl!==i?(this._fadeOut(t,s.out),!1):(this._fadeIn(t,s.in),!0)),t&&t()}_sumArrHeight(t,s){return t.reduce((t,e,i)=>{i%=s;return t[i]||(t[i]=0),t[i]=t[i]+e,t},[])}_columnsCount(t){let i=this["winWidth"];return Object.entries(t).reduce((t,e)=>i>e[0]&&e[0]>=Math.max(t.width)?{width:e[0],columns:e[1].columns}:t,{width:0,columns:4})}_fadeIn(e,t=300,i){let s=parseFloat(window.getComputedStyle(e,null).getPropertyValue("opacity")),n=16/t;e.style.display="block",requestAnimationFrame(function t(){(s+=n)<=1?(e.style.opacity=s,requestAnimationFrame(t)):(e.style.opacity=1,i&&i())})}_fadeOut(e,t=300,i){let s=parseFloat(window.getComputedStyle(e,null).getPropertyValue("opacity")),n=t?16/t:1;requestAnimationFrame(function t(){0<=(s-=n)?(e.style.opacity=s,requestAnimationFrame(t)):(e.style.opacity=0,e.style.display="none",i&&i())})}}